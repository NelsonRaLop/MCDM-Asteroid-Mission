See main and function comments
